pipeline {
    agent any
    
    options {
        timeout(time: 20, unit: 'MINUTES')
        timestamps()
        retry(2)
        buildDiscarder(logRotator(numToKeepStr: '10'))
    }
    
    parameters {
        choice(
            name: 'K8S_CONCEPT',
            choices: ['Pods', 'Services', 'Deployments', 'ConfigMaps', 'Secrets', 'Ingress', 'All Concepts'],
            description: 'Kubernetes concept to explore'
        )
        choice(
            name: 'LEARNING_LEVEL',
            choices: ['Beginner', 'Intermediate', 'Advanced'],
            description: 'Learning complexity level'
        )
        booleanParam(
            name: 'INTERACTIVE_DEMO',
            defaultValue: true,
            description: 'Enable interactive demonstrations'
        )
        booleanParam(
            name: 'HANDS_ON_LAB',
            defaultValue: true,
            description: 'Enable hands-on lab exercises'
        )
        string(
            name: 'NAMESPACE',
            defaultValue: 'k8s-learning',
            description: 'Kubernetes namespace for exercises'
        )
    }
    
    environment {
        K8S_VERSION = '1.28'
        DOCKER_REGISTRY = 'docker.io'
        LEARNING_PROGRESS = '0'
        ACHIEVEMENTS = ''
        CURRENT_CONCEPT = "${params.K8S_CONCEPT}"
        LEARNING_LEVEL = "${params.LEARNING_LEVEL}"
    }
    
    stages {
        stage('ğŸš€ K8s Commander Launch') {
            steps {
                script {
                    echo "ğŸš€ Welcome to K8s Commander - Your Kubernetes Learning Journey!"
                    echo ""
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘                        ğŸ¯ K8S COMMANDER LAUNCH                              â•‘"
                    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
                    echo "â•‘  ğŸ“ Learning Journey: Jenkins â†’ Kubernetes Transition"
                    echo "â•‘  ğŸ“š Concept Focus: ${params.K8S_CONCEPT}"
                    echo "â•‘  ğŸ¯ Learning Level: ${params.LEARNING_LEVEL}"
                    echo "â•‘  ğŸ§ª Interactive Demo: ${params.INTERACTIVE_DEMO ? 'Enabled' : 'Disabled'}"
                    echo "â•‘  ğŸ”¬ Hands-on Lab: ${params.HANDS_ON_LAB ? 'Enabled' : 'Disabled'}"
                    echo "â•‘  ğŸ“¦ Namespace: ${params.NAMESPACE}"
                    echo "â•‘  ğŸ·ï¸  K8s Version: ${env.K8S_VERSION}"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    
                    // Initialize learning progress
                    env.LEARNING_PROGRESS = '0'
                    env.ACHIEVEMENTS = 'ğŸš€ K8s Commander Started'
                }
            }
        }
        
        stage('ğŸ“š Kubernetes Concepts Overview') {
            steps {
                script {
                    echo "ğŸ“š Exploring Kubernetes Concepts through Jenkins..."
                    echo ""
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘                    ğŸ“š KUBERNETES CONCEPTS OVERVIEW                           â•‘"
                    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
                    
                    // Dynamic concept explanation based on selection
                    def conceptExplanations = [
                        'Pods': [
                            'ğŸ¯ What are Pods?',
                            'â€¢ Smallest deployable unit in Kubernetes',
                            'â€¢ Contains one or more containers',
                            'â€¢ Shares network and storage resources',
                            'â€¢ Ephemeral - can be created and destroyed',
                            'â€¢ Example: Web server + sidecar container'
                        ],
                        'Services': [
                            'ğŸŒ What are Services?',
                            'â€¢ Stable network endpoint for Pods',
                            'â€¢ Provides load balancing and service discovery',
                            'â€¢ Types: ClusterIP, NodePort, LoadBalancer',
                            'â€¢ Enables communication between components',
                            'â€¢ Example: Frontend â†’ Backend communication'
                        ],
                        'Deployments': [
                            'ğŸš€ What are Deployments?',
                            'â€¢ Manages Pod replicas and updates',
                            'â€¢ Provides rolling updates and rollbacks',
                            'â€¢ Ensures desired state is maintained',
                            'â€¢ Handles scaling up and down',
                            'â€¢ Example: Web application with 3 replicas'
                        ],
                        'ConfigMaps': [
                            'âš™ï¸ What are ConfigMaps?',
                            'â€¢ Stores configuration data as key-value pairs',
                            'â€¢ Separates configuration from application code',
                            'â€¢ Can be mounted as files or environment variables',
                            'â€¢ Non-sensitive configuration data',
                            'â€¢ Example: Database connection strings'
                        ],
                        'Secrets': [
                            'ğŸ” What are Secrets?',
                            'â€¢ Stores sensitive data (passwords, tokens)',
                            'â€¢ Base64 encoded (not encrypted by default)',
                            'â€¢ Can be mounted as files or environment variables',
                            'â€¢ Better than hardcoding sensitive data',
                            'â€¢ Example: API keys, database passwords'
                        ],
                        'Ingress': [
                            'ğŸŒ What is Ingress?',
                            'â€¢ Manages external access to services',
                            'â€¢ Provides HTTP/HTTPS routing',
                            'â€¢ SSL termination and load balancing',
                            'â€¢ Path-based and host-based routing',
                            'â€¢ Example: myapp.com/api â†’ backend service'
                        ]
                    ]
                    
                    def selectedConcept = params.K8S_CONCEPT
                    if (selectedConcept == 'All Concepts') {
                        conceptExplanations.each { concept, explanation ->
                            echo "â•‘"
                            echo "â•‘  ${concept}:"
                            explanation.each { line ->
                                echo "â•‘     ${line}"
                            }
                        }
                    } else {
                        echo "â•‘  ${selectedConcept}:"
                        conceptExplanations[selectedConcept].each { line ->
                            echo "â•‘     ${line}"
                        }
                    }
                    
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    
                    // Update progress
                    env.LEARNING_PROGRESS = '20'
                    env.ACHIEVEMENTS += ', ğŸ“š Concepts Learned'
                }
            }
        }
        
        stage('ğŸ® Interactive K8s Demo') {
            when {
                expression { params.INTERACTIVE_DEMO == true }
            }
            steps {
                script {
                    echo "ğŸ® Launching Interactive Kubernetes Demo..."
                    echo ""
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘                    ğŸ® INTERACTIVE K8S DEMO                                  â•‘"
                    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
                    
                    // Create interactive demo based on concept
                    sh '''
                        echo "â•‘  ğŸ¯ Interactive Demo: ${CURRENT_CONCEPT}"
                        echo "â•‘  ğŸ“Š Learning Level: ${LEARNING_LEVEL}"
                        echo "â•‘"
                        echo "â•‘  ğŸš€ Simulating Kubernetes operations..."
                        
                        # Simulate kubectl commands based on concept
                        case "${CURRENT_CONCEPT}" in
                            "Pods")
                                echo "â•‘     â€¢ kubectl get pods"
                                echo "â•‘     â€¢ kubectl describe pod my-pod"
                                echo "â•‘     â€¢ kubectl logs my-pod"
                                echo "â•‘     â€¢ kubectl exec -it my-pod -- /bin/bash"
                                ;;
                            "Services")
                                echo "â•‘     â€¢ kubectl get services"
                                echo "â•‘     â€¢ kubectl expose deployment my-app --port=80"
                                echo "â•‘     â€¢ kubectl get endpoints"
                                echo "â•‘     â€¢ kubectl port-forward service/my-service 8080:80"
                                ;;
                            "Deployments")
                                echo "â•‘     â€¢ kubectl get deployments"
                                echo "â•‘     â€¢ kubectl create deployment my-app --image=nginx"
                                echo "â•‘     â€¢ kubectl scale deployment my-app --replicas=3"
                                echo "â•‘     â€¢ kubectl rollout status deployment/my-app"
                                ;;
                            "ConfigMaps")
                                echo "â•‘     â€¢ kubectl get configmaps"
                                echo "â•‘     â€¢ kubectl create configmap my-config --from-literal=key=value"
                                echo "â•‘     â€¢ kubectl describe configmap my-config"
                                echo "â•‘     â€¢ kubectl get configmap my-config -o yaml"
                                ;;
                            "Secrets")
                                echo "â•‘     â€¢ kubectl get secrets"
                                echo "â•‘     â€¢ kubectl create secret generic my-secret --from-literal=password=secret"
                                echo "â•‘     â€¢ kubectl describe secret my-secret"
                                echo "â•‘     â€¢ kubectl get secret my-secret -o yaml"
                                ;;
                            "Ingress")
                                echo "â•‘     â€¢ kubectl get ingress"
                                echo "â•‘     â€¢ kubectl apply -f ingress.yaml"
                                echo "â•‘     â€¢ kubectl describe ingress my-ingress"
                                echo "â•‘     â€¢ kubectl get ingress my-ingress -o yaml"
                                ;;
                            "All Concepts")
                                echo "â•‘     â€¢ kubectl get all"
                                echo "â•‘     â€¢ kubectl get pods,services,deployments"
                                echo "â•‘     â€¢ kubectl get configmaps,secrets"
                                echo "â•‘     â€¢ kubectl get ingress"
                                ;;
                        esac
                        
                        echo "â•‘"
                        echo "â•‘  âœ… Interactive demo completed successfully!"
                        echo "â•‘  ğŸ’¡ These commands would work in a real Kubernetes cluster"
                    '''
                    
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    
                    // Update progress
                    env.LEARNING_PROGRESS = '40'
                    env.ACHIEVEMENTS += ', ğŸ® Demo Completed'
                }
            }
        }
        
        stage('ğŸ”¬ Hands-on Lab Exercise') {
            when {
                expression { params.HANDS_ON_LAB == true }
            }
            steps {
                script {
                    echo "ğŸ”¬ Starting Hands-on Lab Exercise..."
                    echo ""
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘                    ğŸ”¬ HANDS-ON LAB EXERCISE                                 â•‘"
                    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
                    
                    // Create lab exercise files
                    sh '''
                        echo "â•‘  ğŸ¯ Lab Exercise: ${CURRENT_CONCEPT} Practice"
                        echo "â•‘  ğŸ“¦ Namespace: ${NAMESPACE}"
                        echo "â•‘"
                        echo "â•‘  ğŸ“ Creating lab exercise files..."
                        
                        mkdir -p k8s-lab
                        
                        # Create YAML files based on concept
                        case "${CURRENT_CONCEPT}" in
                            "Pods")
                                cat > k8s-lab/pod-example.yaml << 'EOF'
apiVersion: v1
kind: Pod
metadata:
  name: nginx-pod
  labels:
    app: nginx
spec:
  containers:
  - name: nginx
    image: nginx:latest
    ports:
    - containerPort: 80
EOF
                                echo "â•‘     â€¢ Created pod-example.yaml"
                                ;;
                            "Services")
                                cat > k8s-lab/service-example.yaml << 'EOF'
apiVersion: v1
kind: Service
metadata:
  name: nginx-service
spec:
  selector:
    app: nginx
  ports:
  - port: 80
    targetPort: 80
  type: ClusterIP
EOF
                                echo "â•‘     â€¢ Created service-example.yaml"
                                ;;
                            "Deployments")
                                cat > k8s-lab/deployment-example.yaml << 'EOF'
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
EOF
                                echo "â•‘     â€¢ Created deployment-example.yaml"
                                ;;
                            "ConfigMaps")
                                cat > k8s-lab/configmap-example.yaml << 'EOF'
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
data:
  database_url: "mysql://localhost:3306/mydb"
  debug_mode: "true"
  max_connections: "100"
EOF
                                echo "â•‘     â€¢ Created configmap-example.yaml"
                                ;;
                            "Secrets")
                                cat > k8s-lab/secret-example.yaml << 'EOF'
apiVersion: v1
kind: Secret
metadata:
  name: app-secret
type: Opaque
data:
  username: YWRtaW4=  # base64 encoded 'admin'
  password: cGFzc3dvcmQ=  # base64 encoded 'password'
EOF
                                echo "â•‘     â€¢ Created secret-example.yaml"
                                ;;
                            "Ingress")
                                cat > k8s-lab/ingress-example.yaml << 'EOF'
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: app-ingress
spec:
  rules:
  - host: myapp.example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: nginx-service
            port:
              number: 80
EOF
                                echo "â•‘     â€¢ Created ingress-example.yaml"
                                ;;
                            "All Concepts")
                                # Create all example files
                                echo "â•‘     â€¢ Creating comprehensive lab with all concepts..."
                                echo "â•‘     â€¢ This would include Pods, Services, Deployments,"
                                echo "â•‘     â€¢ ConfigMaps, Secrets, and Ingress examples"
                                ;;
                        esac
                        
                        echo "â•‘"
                        echo "â•‘  ğŸ“‹ Lab Instructions:"
                        echo "â•‘     1. Review the generated YAML files"
                        echo "â•‘     2. Understand the structure and fields"
                        echo "â•‘     3. Try applying them to a K8s cluster:"
                        echo "â•‘        kubectl apply -f k8s-lab/"
                        echo "â•‘     4. Verify with: kubectl get all"
                        echo "â•‘"
                        echo "â•‘  âœ… Lab exercise files created successfully!"
                    '''
                    
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    
                    // Update progress
                    env.LEARNING_PROGRESS = '60'
                    env.ACHIEVEMENTS += ', ğŸ”¬ Lab Completed'
                }
            }
        }
        
        stage('ğŸŒ Interactive Learning Dashboard') {
            steps {
                script {
                    echo "ğŸŒ Generating Interactive Learning Dashboard..."
                    echo ""
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘                ğŸŒ INTERACTIVE LEARNING DASHBOARD                           â•‘"
                    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
                    
                    // Generate interactive dashboard
                    sh '''
                        echo "â•‘  ğŸ¯ Creating interactive learning dashboard..."
                        mkdir -p dashboard
                        
                        # Create HTML dashboard
                        cat > dashboard/index.html << 'EOF'
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K8s Commander - Learning Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .header h1 { font-size: 3em; margin-bottom: 10px; color: white; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            transition: width 0.3s ease;
        }
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }
        .card:hover { transform: translateY(-5px); }
        .achievement { display: inline-block; margin: 5px; padding: 5px 10px; background: #4CAF50; color: white; border-radius: 15px; font-size: 0.9em; }
        .concept-highlight { color: #2196F3; font-weight: bold; }
        .level-badge { display: inline-block; padding: 5px 15px; border-radius: 20px; font-weight: bold; }
        .beginner { background: #4CAF50; color: white; }
        .intermediate { background: #FF9800; color: white; }
        .advanced { background: #F44336; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ K8s Commander</h1>
            <p>Your Kubernetes Learning Journey</p>
            <div class="progress-bar">
                <div class="progress-fill" style="width: ${LEARNING_PROGRESS}%"></div>
            </div>
            <p>Progress: ${LEARNING_PROGRESS}% Complete</p>
        </div>
        
        <div class="dashboard">
            <div class="card">
                <h3>ğŸ¯ Current Focus</h3>
                <p><strong>Concept:</strong> <span class="concept-highlight">${CURRENT_CONCEPT}</span></p>
                <p><strong>Level:</strong> <span class="level-badge ${LEARNING_LEVEL.toLowerCase()}">${LEARNING_LEVEL}</span></p>
                <p><strong>Namespace:</strong> ${NAMESPACE}</p>
                <p><strong>K8s Version:</strong> ${K8S_VERSION}</p>
            </div>
            
            <div class="card">
                <h3>ğŸ† Achievements</h3>
                <div id="achievements">
                    ${ACHIEVEMENTS.split(',').map(achievement => `<span class="achievement">${achievement.trim()}</span>`).join('')}
                </div>
            </div>
            
            <div class="card">
                <h3>ğŸ“š Learning Path</h3>
                <ul>
                    <li>âœ… Kubernetes Concepts Overview</li>
                    <li>âœ… Interactive Demo</li>
                    <li>âœ… Hands-on Lab</li>
                    <li>ğŸ”„ Learning Dashboard</li>
                    <li>â³ Next: Advanced K8s Patterns</li>
                </ul>
            </div>
            
            <div class="card">
                <h3>ğŸ® Interactive Features</h3>
                <p><strong>Demo Mode:</strong> ${INTERACTIVE_DEMO ? 'âœ… Enabled' : 'âŒ Disabled'}</p>
                <p><strong>Lab Mode:</strong> ${HANDS_ON_LAB ? 'âœ… Enabled' : 'âŒ Disabled'}</p>
                <p><strong>Real-time Updates:</strong> âœ… Active</p>
            </div>
        </div>
    </div>
    
    <script>
        // Real-time updates
        function updateProgress() {
            const progress = document.querySelector('.progress-fill');
            const currentProgress = parseInt('${LEARNING_PROGRESS}');
            progress.style.width = currentProgress + '%';
        }
        
        // Simulate learning progression
        let progress = parseInt('${LEARNING_PROGRESS}');
        setInterval(() => {
            if (progress < 100) {
                progress += Math.random() * 5;
                if (progress > 100) progress = 100;
                document.querySelector('.progress-fill').style.width = progress + '%';
                document.querySelector('.header p:last-child').textContent = 'Progress: ' + Math.round(progress) + '% Complete';
            }
        }, 2000);
        
        updateProgress();
    </script>
</body>
</html>
EOF
                        
                        echo "â•‘     â€¢ Interactive dashboard created"
                        echo "â•‘     â€¢ Real-time progress tracking enabled"
                        echo "â•‘     â€¢ Achievement system active"
                        echo "â•‘"
                        echo "â•‘  ğŸŒ Dashboard Features:"
                        echo "â•‘     â€¢ Live progress tracking"
                        echo "â•‘     â€¢ Achievement badges"
                        echo "â•‘     â€¢ Learning path visualization"
                        echo "â•‘     â€¢ Interactive concept exploration"
                        echo "â•‘     â€¢ Real-time updates"
                    '''
                    
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    
                    // Update progress
                    env.LEARNING_PROGRESS = '80'
                    env.ACHIEVEMENTS += ', ğŸŒ Dashboard Created'
                }
            }
        }
        
        stage('ğŸ“ K8s Mastery Assessment') {
            steps {
                script {
                    echo "ğŸ“ Conducting K8s Mastery Assessment..."
                    echo ""
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘                    ğŸ“ K8S MASTERY ASSESSMENT                               â•‘"
                    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
                    
                    sh '''
                        echo "â•‘  ğŸ“Š Assessment Results:"
                        echo "â•‘     â€¢ Concept Understanding: âœ… Excellent"
                        echo "â•‘     â€¢ Hands-on Practice: âœ… Completed"
                        echo "â•‘     â€¢ Interactive Learning: âœ… Engaged"
                        echo "â•‘     â€¢ Progress Tracking: âœ… ${LEARNING_PROGRESS}%"
                        echo "â•‘"
                        echo "â•‘  ğŸ† Mastery Level Achieved:"
                        case "${LEARNING_LEVEL}" in
                            "Beginner")
                                echo "â•‘     â€¢ ğŸ¥‰ Bronze Level - K8s Explorer"
                                echo "â•‘     â€¢ Ready for: Basic K8s operations"
                                echo "â•‘     â€¢ Next: Intermediate concepts"
                                ;;
                            "Intermediate")
                                echo "â•‘     â€¢ ğŸ¥ˆ Silver Level - K8s Practitioner"
                                echo "â•‘     â€¢ Ready for: Production deployments"
                                echo "â•‘     â€¢ Next: Advanced patterns"
                                ;;
                            "Advanced")
                                echo "â•‘     â€¢ ğŸ¥‡ Gold Level - K8s Master"
                                echo "â•‘     â€¢ Ready for: Complex architectures"
                                echo "â•‘     â€¢ Next: K8s administration"
                                ;;
                        esac
                        echo "â•‘"
                        echo "â•‘  ğŸ¯ Key Learnings:"
                        echo "â•‘     â€¢ Kubernetes concepts through Jenkins"
                        echo "â•‘     â€¢ YAML configuration understanding"
                        echo "â•‘     â€¢ kubectl command familiarity"
                        echo "â•‘     â€¢ Real-world application patterns"
                        echo "â•‘"
                        echo "â•‘  ğŸš€ Next Steps:"
                        echo "â•‘     â€¢ Practice with real K8s cluster"
                        echo "â•‘     â€¢ Explore advanced K8s features"
                        echo "â•‘     â€¢ Learn K8s administration"
                        echo "â•‘     â€¢ Master CI/CD with K8s"
                    '''
                    
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    
                    // Final progress update
                    env.LEARNING_PROGRESS = '100'
                    env.ACHIEVEMENTS += ', ğŸ“ Mastery Achieved'
                }
            }
        }
    }
    
    post {
        always {
            script {
                echo ""
                echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                echo "â•‘                    ğŸ‰ K8S COMMANDER COMPLETED!                               â•‘"
                echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
                echo "â•‘  ğŸ¯ Learning Journey Summary:"
                echo "â•‘     â€¢ Concept Explored: ${params.K8S_CONCEPT}"
                echo "â•‘     â€¢ Learning Level: ${params.LEARNING_LEVEL}"
                echo "â•‘     â€¢ Progress Achieved: ${env.LEARNING_PROGRESS}%"
                echo "â•‘     â€¢ Achievements: ${env.ACHIEVEMENTS}"
                echo "â•‘"
                echo "â•‘  ğŸŒ Access Your Learning Dashboard:"
                echo "â•‘     â€¢ Local: http://localhost:8080/dashboard/"
                echo "â•‘     â€¢ Network: http://$(hostname -I | awk '{print $1}'):8080/dashboard/"
                echo "â•‘"
                echo "â•‘  ğŸš€ Ready for Next Level:"
                echo "â•‘     â€¢ Scenario 5: Jenkins CI/CD Mastery"
                echo "â•‘     â€¢ Advanced Jenkins features"
                echo "â•‘     â€¢ Production-ready CI/CD patterns"
                echo "â•‘     â€¢ Then: Full Kubernetes deployment"
                echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            }
        }
        success {
            script {
                echo "ğŸ‰ K8s Commander learning journey completed successfully!"
                echo "ğŸ† You've mastered Kubernetes concepts through Jenkins!"
            }
        }
        failure {
            script {
                echo "âŒ K8s Commander encountered issues, but learning continues!"
                echo "ğŸ”„ Retry the pipeline to continue your journey."
            }
        }
    }
}